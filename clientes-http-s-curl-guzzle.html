<!doctype html>
<html lang="es">
<head>
    <meta charset="utf-8" />
    <title>Sitio Web de David León - Clientes HTTP/S: curl o guzzle</title>
    <meta description="Publicación de noticias, tips y tutoriales de programación y tecnologías de la información" />
    <meta name="author" content="David León">
    <meta author="David León" />
    <link rel="icon" href="./theme/favicon.ico">
    <meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0' name='viewport' />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons" />
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700" />
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/latest/css/font-awesome.min.css" />
    <link href="./theme/assets/css/bootstrap.min.css" rel="stylesheet"/>
    <link href="./theme/assets/css/materialkit.css" rel="stylesheet"/>
    <link href="./theme/assets/css/main.css" rel="stylesheet"/>
</head>

<body>
<nav class="navbar navbar-fixed-top navbar-color-on-scroll">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navigation-example">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="http://davfl.com.mx/">David León</a>
        </div>

        <div class="collapse navbar-collapse" id="navigation-example">
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="/archives.html">
                        <i class="fa fa-archive"></i> Base de Conocimientos
                    </a>
                </li>
                <li>
                    <a href="https://poetadeocasion.wordpress.com/" title="Blog" target="_blank">
                        <i class="fa fa-heart-o"></i> d'Ocasión
                    </a>
                </li>
                <li>
                    <a href="https://haridandleon.wordpress.com/" title="Entretenimiento" target="_blank">
                        <i class="fa fa-rebel"></i> Otros
                    </a>
                </li>
                <li>
                    <a href="https://twitter.com/jelidleon" target="_blank" class="btn btn-simple btn-white btn-just-icon">
                        <i class="fa fa-twitter"></i>
                    </a>
                </li>
                <li>
                    <a href="https://github.com/eisenheimjelid/" target="_blank" class="btn btn-simple btn-white btn-just-icon">
                        <i class="fa fa-github"></i>
                    </a>
                </li>
                <li>
                    <a href="https://www.tumblr.com/blog/jelid" target="_blank" class="btn btn-simple btn-white btn-just-icon">
                        <i class="fa fa-tumblr"></i>
                    </a>
                </li>
            </ul>
        </div>
    </div>
</nav>    <div class="wrapper">
        <div class="header header-filter article-head" style="background-image: url('./theme/assets/img/background.jpg');">
            <div class="container">
                <div class="row">
                    <div class="col-md-12">
                        <h1 class="title">Clientes HTTP/S: curl o guzzle</h1>
                    </div>
                </div>
            </div>
        </div>
        <div class="main main-raised">
            <div class="container"><br />
            <div class="row">
                    <div class="col-sm-8 col-md-8 col-sx-12 col-lg-9">
                    <div class="article-contenido">
                        <h2>Introducción</h2>
<p>Hoy en día esta algo de moda la arquitectura de "<em>Microservicios</em>", que permite crear y mantener sistemas complejos, interactuando entre distintos servicios que hacen pocas "operaciones" muy bien, de manera independiente (de recursos). Pero en el desarrollo de este tipo de sistemas, se usan las llamadas de HTTP/S como la amalgama que permite la interacción entre cada uno de esos elementos. Para unos como cliente que consume los servicios <strong>API RESTful</strong>, y en otras formas como el insumo que requieren ciertos sistemas.</p>
<p><img alt="microservicios" src="https://cdn-images-1.medium.com/max/1600/1*IiyPCOKiGOf65UmGedPrlw.png"></p>
<blockquote>
<p><strong>Cliente HTTP/S</strong>: Es un "algo" parecido a un navegador Web, pero sin todo lo adicional (js, ui, html, css); solo el puro contenido (texto, mayormente).</p>
</blockquote>
<h2>Curl</h2>
<p>Es una <strong>librería</strong> propia de PHP, que nos permite conectarnos y comunicarnos con diferentes tipos de servidores usando diferentes tipos de protocolos como http, https, ftp, entre otros. No es necesario instalar nada adicional, pues PHP ya lo tiene inlcuido dentro de su código. Además, existen ejemplos de código para <a href="http://nlslack.com/ftp-access-using-curl-with-php/" title="Conectar a un FTP con Curl">conectar a un servicio de FTP por medio de Curl</a>.</p>
<h2>Guzzle</h2>
<p>Guzzle es un cliente HTTP/S de PHP que facilita el envío de solicitudes HTTP y la integración sencilla con los servicios web. A diferencia de curl, Guzzle solo hace peticiones a HTTP/S, y no considera peticiones bajo algún otro protocolo. Es necesario instalar este cliente por medio de <a href="http://getcomposer.org">Composer</a> (es lo recomendado):</p>
<h3>Instalar Guzzle</h3>
<div class="highlight"><pre><span></span><code><span class="c1"># Instalar Composer</span>
curl<span class="w"> </span>-sS<span class="w"> </span>https://getcomposer.org/installer<span class="w"> </span><span class="p">|</span><span class="w"> </span>php
</code></pre></div>

<p>Después, correr el comando de composer para instalar la versión última estable de Guzzle:</p>
<div class="highlight"><pre><span></span><code>php<span class="w"> </span>composer.phar<span class="w"> </span>require<span class="w"> </span>guzzlehttp/guzzle
</code></pre></div>

<p>Después, es necesario agregar el autoloader de Composer al código:</p>
<div class="highlight"><pre><span></span><code><span class="x">require &#39;vendor/autoload.php&#39;;</span>
</code></pre></div>

<h2>Ejemplos practicos de Curl y Guzzle</h2>
<p>Para la charla que preparé con este tema, preparé algunos ejemplos que pueden consultar en el <a href="https://github.com/phpwaymx/curlguzzle" title="Repositorio con el código de ejemplo">repositorio de github</a>, y que explico a grandes rasgos, aquí mismo:</p>
<h3>php -f curl_01.php</h3>
<p>Este archivo va a obtener de manera simple la respuesta de example.com, presentando en la terminal el código HTML que responde ese sitio. Además, esta comentada una línea, para que se ejecute como una versión adicional, ejemplificando el error del encabezado de agente en las peticiones HTTP/S. Este agente se manda siempre con toda petición, y muchos servidores la toman como referencia para saber si descartar o no la solicitud.</p>
<p>Cuando utilizamos Curl, es muy sencillo omitir este punto que se considera importante por muchos servicios. Entre este, cada uno de todos los <a href="https://en.wikipedia.org/wiki/List_of_HTTP_header_fields" title="Consultar todos los encabezados del estándar">headers de HTTP</a> se pueden enviar/leer en cada solicitud/respuesta.</p>
<h3>php -f curl_02.php</h3>
<p>Con este ejemplo, mostramos todo lo que hace el Curl <em>tras bambalinas</em>, sobre como va construyendo la petición, y todos los valores que obtiene de la respuesta de esta solicitud/respuesta.</p>
<h3>php -f guzzle_01.php</h3>
<p>Similar al primer ejemplo de Curl, aquí se muestra el código mínimo necesario para poder realizar una solicitud con Guzzle, muy básica; pero que al ser un código <em>moderno</em> se requiere una línea adicional, para considerar lo que hicimos en el punto de Composer y la instalación de Guzzle.</p>
<h3>php -f guzzle_02.php</h3>
<p>Similar al segundo ejemplo de Curl, aquí se muestra el código que permite mostrar lo que hace <em>tras bambalinas</em> la libreria, al momento de construir la solicitud y obtener la respuesta del servicio.</p>
<h2>Meetup de PHP México, para este 27 de junio en la <a href="https://goo.gl/maps/jiJeYy6MuHB7AxMH8" title="cómo llegar a la Estela de Luz">Estela de Luz</a></h2>
<p>El repositorio que preparé para la charla, es para el grupo de programadores que organiza en Ciudad de México el evento, y están invitados a participar este 27 de Junio; todos los detalles en <a href="https://www.meetup.com/es/PHP-The-Right-Way/events/258972833/">meetup.com</a>.</p>
<p>Además, si no pueden asistir a esta edición se pueden apuntar a la siguiente meetup. Aunque si gustan de PHP, o son solo desarrolladores Web también estan invitados a participar en <a href="https://chat.phpmexico.mx/" title="Solicitar invitación al Slack de PHPMX">el canal de Slack de la comunidad</a>.</p>
<p>Gracias por leer el artículo, y espero les sea de utilidad estos ejemplos de código.</p>
<h4>Fuentes:</h4>
<ol>
<li><a href="https://github.com/guzzle/guzzle" title="Repositorio oficial de Guzzle">Guzzle Repo Github</a></li>
<li><a href="https://www.php.net/manual/es/book.curl.php" title="Manual de php.net">Manual de Curl PHP</a></li>
<li><a href="https://dzone.com/articles/make-a-post-request-from-php-with-guzzle" title="Artículo de DZone">Ejemplos de POST con Guzzle</a></li>
<li><a href="http://nlslack.com/ftp-access-using-curl-with-php/" title="Conectar a un FTP con Curl">Ejemplo de FTP con Curl</a></li>
<li><a href="https://github.com/phpwaymx/curlguzzle" title="Código para la charla de la meetup">Repositorio de PHPMX</a></li>
</ol>
                    </div>
<div class="meta align-right">
  Publicado el <time datetime="2019-06-25T13:00:00-05:00" pubdate="pubdate">25 de junio, 2019</time>.
  Categoria «<span class="label label-primary catego"><a href="./category/php.html">Php</a></span>».  
 Etiquetado como: <span class="label label-success catego"><a href="./tag/curl.html">curl</a></span>, <span class="label label-success catego"><a href="./tag/php.html">php</a></span>, <span class="label label-success catego"><a href="./tag/guzzle.html">guzzle</a></span></p></div>                     <div class="sharethis-inline-share-buttons">
                        
                    </div>
                    <div><h4>Comentarios</h4>
<div id="disqus_thread"></div>
<script>

/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
/*
var disqus_config = function () {
this.page.url = .clientes-http-s-curl-guzzle.html;  // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = clientes-http-s-curl-guzzle.html; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
*/
(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = 'https://davflsite.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>                    </div>
                    </div>
                    <div class="col-sm-4 col-md-4 col-sx-12 col-lg-3"><br />
<a href="/categories.html" title="Categorias y Etiquetas">Listado de Categorias y Etiquetas.</a><br />
<div class="twitter-sidebar" id="twitter-sidebar">
<a class="twitter-timeline" href="https://twitter.com/jelidleon"  data-tweet-limit="5">Tweets by jelidleon</a> <script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
</div><div class="col-md-12">
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- www.DAVFL-sidebar2 -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-5724119311477890"
     data-ad-slot="1367534401"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div><br />                    </div>
                </div>
<br />
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- www.DAVFL-footer -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-5724119311477890"
     data-ad-slot="3263070005"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>                <br />
            </div>
        </div>

<footer class="footer">
    <div class="container">
        <nav class="pull-left">
            <ul>
                <li>
                    <a href="/author/david-leon" target="_blank" title="Más sobre mi">
                        <i class="fa fa-info"></i> Sobre mi en la red
                    </a>
                </li>
                <li>
                    <a href="/archives.html">
                       <i class="fa fa-archive"></i> Base de Conocimientos
                    </a>
                </li>
                <li>
                    <a href="https://poetadeocasion.wordpress.com/" title="Blog Poeta de Ocasión" target="_blank">
                       <i class="fa fa-heart-o"></i> d'ocasión
                    </a>
                </li>
                <li>
                    <a href="/pages/licencia.html">
                        <i class="fa fa-cc"></i> Licencia
                    </a>
                </li>
            </ul>
        </nav>
        <div class="copyright pull-right">
            <a href="/author/david-leon">David León</a>
        </div>
    </div>
</footer>    </div>
</body>
    <script src="./theme/assets/js/jquery.min.js" type="text/javascript"></script>
    <script src="./theme/assets/js/bootstrap.min.js"></script>
    <script src="./theme/assets/js/material.min.js"></script>
    <script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=58cd4861115dd2001125f1ea&product=inline-share-buttons"></script>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-5L1GPZTGNF"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-5L1GPZTGNF');
    </script></html>